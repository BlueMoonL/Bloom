<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join</title>
    <link rel="stylesheet" href="./css/join.css">

</head>
<body>
	<form action="./addUser.jsp" method="post">
    <div id="container">
        <div id="join_content">
            <label for="id">아이디</label>
             <i class="idCheck fa-sharp fa-solid fa-check"></i><br>
            <input type="text" id="id" name="id" class="int" title="ID" maxlength="20" placeholder="아이디를 입력하세요" required><br>
            <label for="pw1">비밀번호</label>
            <i class="iconCheck fa-sharp fa-solid fa-check"></i><br>
            <input type="password" id="pw1" name="pw1"maxlength="20"placeholder="비밀번호를 입력하세요" required><br>
            <label for="pw2">비밀번호 재확인</label>
            <i class="iconCheck fa-sharp fa-solid fa-check" id="iconCheck"></i><br>
            <input type="password" id="pw2" name="pw2"maxlength="20"placeholder="비밀번호를 입력하세요" required><br>
            <label for="name">이름</label><br>
            <input type="text" id="name" name="name"maxlength="10"placeholder="이름을 입력하세요" required><br>
            <label for="email">본인 확인 이메일</label>
            <label id="emailchoice">(선택)</label><br>
            <input type="email" name="email"maxlength="20"><br>
            <input type="submit" value="가입하기"></button>
        </div>
    </div>
    </form>
</body>
</html>
<script>
	var id = document.getElementById("id");
	console.log(id);
	let idElems = document.querySelectorAll(".idCheck");
	id.addEventListener("change", function (e) {
		fetch("http://localhost:8080/bloom/checkId.jsp?userid=" + id.value)
			.then((response) => response.text())	
			.then((result) => {
				console.log("바디 텍스트:", result + "end");
				if ( result != 1) {
					idElems.forEach((e) => e.classList.toggle("valid"));
				} else {
					idElems.forEach((e) => e.classList.remove("valid"));
				}
			})
		});
	
	var pw1 = document.getElementById("pw1");	
	var pw2 = document.getElementById("pw2");
    let elems = document.querySelectorAll(".iconCheck");
    
    pw1.addEventListener("change", function (e) {
        console.log(pw1.value);
        if (pw1.value == "" || pw2.value == "") {
        	elems.forEach((e) => e.classList.remove("valid"));
        } else if (pw1.value == pw2.value) {
        	elems.forEach((e) => e.classList.toggle("valid"));
        } else {
        	elems.forEach((e) => e.classList.remove("valid"));
        } 
    })
    
	pw2.addEventListener("change", function (e) {
        console.log(pw1.value);
        if (pw1.value == "" || pw2.value == "") {
        	elems.forEach((e) => e.classList.remove("valid"));
        } else if (pw1.value == pw2.value) {
        	elems.forEach((e) => e.classList.toggle("valid"));
        } else {
        	elems.forEach((e) => e.classList.remove("valid"));
        }
    })
	
</script>